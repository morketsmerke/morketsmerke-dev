<!DOCTYPE html>
	<html>
		<head>
			<meta charset="utf-8" />
			<link rel="icon" type="image/png" href="https://i.ibb.co/khy45hh/mm.png">
			<style>
				.code-block {
					display: block;
					background-color: silver;
					font-family: monospace;
					font-weight: bolder;
				}
				.code-inline {
					background-color: silver;
					font-family: monospace;
					font-weight: bolder;
				}
				p { text-align: justify; }
			</style>
		</head>


		<body style="font-family: monospace;" >
<pre>
  _______            ___   ______     _      __
 /_  __(_)___  _____( _ ) /_  __/____(_)____/ /_______
  / / / / __ \/ ___/ __ \/|/ / / ___/ / ___/ //_/ ___/
 / / / / /_/ (__  ) /_/  &lt;/ / / /  / / /__/ ,&lt; (__  )
/_/ /_/ .___/____/\____/\/_/ /_/  /_/\___/_/|_/____/
     /_/
</pre>

		<p style="margin: 15px; padding: 0; outline: 0; font-size: 18pt;">
			&#9760;&nbsp;<a href="https://morketsmerke.github.io/">morketsmerke</a>&nbsp;&#9760;
		</p>

		<div style="margin-left: auto; margin-right: auto; width: 80%;">
      <p>
        W zeszłym tygodniu na mój warszta trafiły dwa laptopy. Jeden zupełnie
        nowy, zakupiony na potrzeby programu diagnostycznego dla ciężarówek.
        Drugi zaś nieco już zużyty. Ów program jest rozpowadzany na zasadzie
        gotowego środowiska znajdującego się na maszynie wirtualnej VMware.
        Mój zleceniodawca poprosił mnie abym oczyścił ten stary laptop i
        generalnie przystosował go do tego aby działa na nim tylko ten program
        nic więcej. Starszy laptop to <em>Dell Inspiron 3542</em> z i3 czwartej
        generacji, 4GB ramu oraz tradycjnym dyskiem talerzowym o pojemności
        500GB. Szału nie ma, na VMware ten laptop jest za słaby. Sprawdziłem
        że sama maszyna ma przydzielone 3 GB, najwyraźniej tyle wymaga.
      </p>
      <p>
        Do głowy przyszedł mi pomysł: a co jeśli by wyciągnąć obraz dysku z
        maszyny. Na początku straciłem trochę czasu, na szukanie sprawdzonego
        narzędzia, które musiało zginąć pod czas awarii uszkodzenia przez mnie
        LVM-u na serwerze plików w warsztacie. No cóż stwierdziłem, że jak
        nie mam obrazu, to go zrobie. Niestety po odszukaniu na gryzoniu
        programu w odpowiedniej wersji, nie byłem wstanie utworzyć obrazu płyty
        gdyż ADK dla Windows 8.1, nie jest już dostępne. Microsoft radzi użycie
        ADK dla Windows 10, program nie chce jednak tego przyjąć. A utworzone
        na pendrivie środowisko oparte na Linux, nie miało w ogóle funkcji
        funkcji utworzenia kopii zapasowej dysku. Więc zacząłem szukać jakiejś
        alternatywy, najlepiej <em>open source</em> i do głowy wpadła mi
        <strong>Clonezilla</strong> - to dystrybucja GNU/Linux oparta na
        Debianie służąca tworzeniu kopii zapasowych partycji czy całych dysków.
      </p>
      <p>
        Obrazy przeznaczone dla i386 oraz amd64 znajdziemy na stronie projektu.
        Tu warto zaznaczyć, że najpiej jest wybrać jako mirror <em>OSDN</em>.
        Dla celów testowych przedstawie przypadek, przeniesienia Windows 7 
        Starter 32 bit na netbooka Acer Aspire One. Aby przenieść system z
        maszyny wirtualnej najlepiej jest operować, udziałem <em>Samba</em>.
        Ponieważ te pliki musimy zgrać na fizyczny sprzęt, więc muszą się
        pojawić na fizycznym nośniku, a <em>Clonezilla</em> jest wstanie 
        utworzyć backup dysku na udziale sieciowym. Tak wygląda maszyna
        wirtualna, z której będziemy przenosić nasz system
      </p>
      <p>
        <img src="https://i.ibb.co/j5qWW3X/01-clonezilla-okno-z-maszyn.jpg" alt="01-clonezilla-okno-z-maszyn" border="0" style="width: 100%;">
      </p>
      <p>
        Pracę rozpoczynamy od załadowania do wirtualnego napędu obrazu płyt z
        obrazem iso <em>Clonezilla</em>, do maszyny wirtualnej i uruchomienie
        jej z tego orazu. Z menu programu rozruchowego wybieramy pierwszą,
        domyślną opcję.
      </p>
      <p>
        Po uruchomieniu zostaniemy zapytani o ustawienia lokalizacyjne takiej
        jak język (<em>Clonezilla</em> jest po polsku) oraz układ klawiatury
        (pozostawiamy go domyślnie). Nastepnie uruchamiamy już właściwy
        proces wybierając opcje <em>Start_Clonezilla</em>.
      </p>
      <p>
        Program może pracować w wielu trybach, jednak nas będzie interesować
        wyłącznie praca z obrazmi dlatego w następnym oknie wybieramy opcje
        <em>device-image</em>.
      </p>
      <p>
        Tak jak już wspomniałem na wstępnie, jako miejsca docelowego na obraz
        wykorzystamy udział samba. Tworząc obrazy na fizycznych maszynach
        możemy użyć pendrive-a lub dysku zewnetrznego, jednak w naszym
        przypadku potrzeba by nieco więcej zachodu aby przekazać maszynie dysk
        zewnętrzny, a i wydajność mogła być niezbyt zadowalająca. Dlatego też
        teraz wybieramy opcje <em>samba_server</em>. 
      </p>
      <p>
        Przechodząc przez kolejne okna będziemy musieli podać wszystkie
        parametry potrzebne do połączenia z udziałem. Jednak najpierw musimy
        dokonać konfiguracji sieci środowiska <em>Clonezilla</em>. Najlepiej
        aby pobrać ją z serwera DHCP, więc pozostawiamy domyślną opcję
        <em>dhcp</em>. Po tej konfiguracji przysła pora na podanie parametrów
        do połączenia się z udziałem.
      </p>
      <p>
        Podajemy kolejno: adres ip serwera <em>Samba</em>, domenę (jeśli domena
        nie jest
        ustawiona na serwerze, wybieramy przycisk "Anuluj"), nazwę użytkownika
        mającego uprawnienia do zapisu na docelowym udziale, nazwę udziału (
        uwaga, po <em>slashu</em> - jak by to był folder, ale to nazwa udziału).
        Po podaniu ostatniej informacji, zostaniemy poproszeni o wybór wersji
        protokołu SMB. Mój serwer to <em>Samba</em> postawiona na Debian 10, 
        więc pozostawiam tę wartość domyślnie. Kolejną jest "tryb
        bezpieczestwa", jeśli udział nie stoi na jakimś archaiczym Windowsie
        pozostawiamy <em>auto</em>. Po zatwierdzeniu tej opcji, zostanie nam
        wyświetlony monit o potrzebie podania hasła, do udziału. Polecenie
        pokazane w oknie jest tylko poglądowe i nie ma nic wspólnego z
        właściwym poleceniem montującym udział, po wybraniu "OK" zostanie
        zwrócony znak zachęty, proszący o hasło aby podmontować udział. Każdy
        kto, kiedyś montował udział SMB za pomocą wiersza polecenia będzie
        znać ten znak.
      </p>
      <p>
        Po prawidłowym podłączeniu udziału, <em>Clonezilla</em> zwróci nam
        tabelę z informacjami na temat udziału (głównie dostępnej przestrzeni
        dyskowej oraz punkcie montowania). Po zamontowaniu miejsca docelowego
        w <em>/home/partimag</em>, pora wybrać tryb pracy programu
        <em>Clonezilla</em>. Do wyboru będziemy mieli tryb <em>Beginner</em> -
        początkujący lub <em>Expert</em>. Jako iż jest to moja pierwsza w ogóle
        styczność z tym narzędziem, sam wybrałem tryb dla początkujących. 
      </p>
      <p>
        Po uruchomieniu programu dla początkujących, musimy zaznaczyć sposób
        tworzenia kopii. <em>Clonezilla</em> może tworzyć kopie całych dysków 
        lub
        poszczególnych partycji. Dla rozpatrywanego przypadku najlepszym
        rozwiązaniem jest zapisanie całego dysku. Instalacja najnowszych
        systemów Windows jest zazwyczaj rozbijana na kilka partycji. Zatem
        wybieramy opcje <em>savedisk</em>.
      </p>
      <p>
        W następnym oknie zostaniem poproszeni o podanie nazwy dla katalogu,
        w którym przechowywany będzie obraz. To dobry i jedyny moment, aby go
        opisać. Na przykład: "Windows7_Starter_AOD260", (AOD260 to oznaczenie
        modelu mojego netbooka).
      </p>
      <p>
        Po utworzeniu odpowiedniego katalogu, pora na wybór dysku źródłowego.
        Zaznaczamy dysk z listy, przechodzimy na przycisk "OK" i klikamy Enter.
      </p>
      <p>
        W kolejnym pytaniu program za sugeruje man sprawdzenie i ewenualną
        naprawę systemu plików. Jednak dla systemów takicj jak NTFS jest to 
        nie możliwe, więc wybieramy opcje <em>-sfsck</em> (pominięcie
        sprawdzenia systemu plików). Domyślnie <em>Clonezilla</em> chce 
        sprawdzić
        poprawność zapisanego obrazu. W tym przypadku zostawiam pełną
        dowolność. Ja, aby nie przedłużać tworzenia obrazu, czy zakończenia
        procesu pominołem sprawdzanie obrazu. 
      </p>
      <p>
        Kolejne okno zawiera pytanie o
        szyforwanie obrazu, tutaj również pozostawiam dowolność, jednak jeśli
        tworzymy obraz zaszyfrowanego dysku, to sam obraz również dobrze jest
        zaszyfrować.
      </p>
      <p>
        Przed wykonaniem obrazu należy zdefiniować jeszcze
        czynność wykonywaną po ukończeniu tego procesu. Co ma zrobić 
        <em>Clonezilla</em>. Może przejść do wiersza poleceń, wyłączyć lub
        zrestartować komputer. Może również przjeść menu, z którego wybierzemy
        czynność, ta czynność jest przydatna kiedy chcemy utworzyć obrazy 
        większej ilości dysków, ponieważ będzie możliwe z poziomu tego menu
        ponowne uruchomienie narzędzia z zamontowanym już miejscem docelowym
        dla obrazu. Tutaj też możemy wybrać dowolnie. Ja wybrałem opcję
        <em>-choose</em> uruchamiającą owe menu.
      </p>
      <p>
        Teraz kiedy wszystkie ustawienia zostały przyjęte. <em>Clonezilla</em>
        wyświetli polecenie, którego możemy użyć korzystając z wiersza poleceń,
        aby utworzyć obraz bez przechodzenia przez te wszystkie okna. Klikamy
        "Enter" w celu kontynuowania działania programu.
      </p>
      <p>
        Po przetworzeniu kilku informacji o dysku źródłowym, program wyświetli
        informacje o tym, że zostanie utworzony obraz źródłowego dysku oraz
        pytanie czy chcemy kontynuować. Potwierdzamy klawiszem "Enter".
      </p>
      <p>
        W tym momencie rozpoczyna pracę już właściwy program <strong>Partclone</strong>
        znany między innymi z projektu FOG (Free OpenSource Ghost - ma podobne
        zastosowanie co <em>Clonezilla</em>, jednak jest bardziej ukierunkowny
        na wykorzystanie sieciowe oraz masowe. Przydaje się przy reinstalacji
        systemów operacyjnych w szkolnych salach komputerowych).
      </p>
		</div>

		<p style="margin: 15px; padding: 0; outline: 0;">
			2022; COPYLEFT; ALL RIGHTS REVERSED;
		</p>

		</body>
	</html>
